{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the CreatorX SEO platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "firstName": {
          "type": "string",
          "description": "User's first name."
        },
        "lastName": {
          "type": "string",
          "description": "User's last name."
        },
        "createdAt": {
          "type": "string",
          "description": "Date and time the user account was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Date and time the user account was last updated.",
          "format": "date-time"
        },
        "subscriptionId": {
          "type": "string",
          "description": "Reference to Subscription. (Relationship: User 1:1 Subscription)"
        }
      },
      "required": [
        "id",
        "email",
        "firstName",
        "lastName",
        "createdAt",
        "updatedAt"
      ]
    },
    "ChannelAccount": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChannelAccount",
      "type": "object",
      "description": "Represents a YouTube channel or Instagram account connected to CreatorX SEO.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the channel/account."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N ChannelAccount)"
        },
        "platform": {
          "type": "string",
          "description": "Platform of the channel/account (e.g., YouTube, Instagram)."
        },
        "channelName": {
          "type": "string",
          "description": "Name of the channel/account."
        },
        "channelUrl": {
          "type": "string",
          "description": "URL of the channel/account.",
          "format": "uri"
        },
        "createdAt": {
          "type": "string",
          "description": "Date and time the channel/account was connected.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "platform",
        "channelName",
        "channelUrl",
        "createdAt"
      ]
    },
    "ContentIdea": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ContentIdea",
      "type": "object",
      "description": "Represents a content idea generated by CreatorX SEO.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the content idea."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N ContentIdea)"
        },
        "categoryId": {
          "type": "string",
          "description": "Reference to Category. (Relationship: Category 1:N ContentIdea)"
        },
        "title": {
          "type": "string",
          "description": "Title of the content idea."
        },
        "description": {
          "type": "string",
          "description": "Description of the content idea."
        },
        "tags": {
          "type": "string",
          "description": "Tags associated with the content idea."
        },
        "createdAt": {
          "type": "string",
          "description": "Date and time the content idea was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "title",
        "description",
        "tags",
        "createdAt"
      ]
    },
    "Keyword": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Keyword",
      "type": "object",
      "description": "Represents a keyword researched using CreatorX SEO.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the keyword."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Keyword)"
        },
        "keyword": {
          "type": "string",
          "description": "The keyword itself."
        },
        "searchVolume": {
          "type": "number",
          "description": "Search volume of the keyword."
        },
        "trend": {
          "type": "string",
          "description": "Trend data for the keyword."
        },
        "difficultyScore": {
          "type": "number",
          "description": "Difficulty score of the keyword."
        },
        "createdAt": {
          "type": "string",
          "description": "Date and time the keyword was researched.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "keyword",
        "searchVolume",
        "trend",
        "difficultyScore",
        "createdAt"
      ]
    },
    "Competitor": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Competitor",
      "type": "object",
      "description": "Represents a competitor channel or video analyzed by CreatorX SEO.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the competitor."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Competitor)"
        },
        "channelUrl": {
          "type": "string",
          "description": "URL of the competitor's channel.",
          "format": "uri"
        },
        "createdAt": {
          "type": "string",
          "description": "Date and time the competitor was analyzed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "channelUrl",
        "createdAt"
      ]
    },
    "VideoMetrics": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "VideoMetrics",
      "type": "object",
      "description": "Represents metrics for a video tracked by CreatorX SEO.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the video metrics."
        },
        "channelAccountId": {
          "type": "string",
          "description": "Reference to ChannelAccount. (Relationship: ChannelAccount 1:N VideoMetrics)"
        },
        "videoId": {
          "type": "string",
          "description": "Video's id"
        },
        "impressions": {
          "type": "number",
          "description": "Number of impressions for the video."
        },
        "ctr": {
          "type": "number",
          "description": "Click-through rate for the video."
        },
        "watchTime": {
          "type": "number",
          "description": "Watch time for the video."
        },
        "engagementRate": {
          "type": "number",
          "description": "Engagement rate for the video."
        },
        "rankPositions": {
          "type": "string",
          "description": "Rank positions for the video's keywords."
        },
        "recordedAt": {
          "type": "string",
          "description": "Date and time the metrics were recorded.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "channelAccountId",
        "videoId",
        "impressions",
        "ctr",
        "watchTime",
        "engagementRate",
        "rankPositions",
        "recordedAt"
      ]
    },
    "TrendEvent": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TrendEvent",
      "type": "object",
      "description": "Represents a trending event relevant to a user's niche.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the trend event."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N TrendEvent)"
        },
        "topic": {
          "type": "string",
          "description": "Topic of the trending event."
        },
        "description": {
          "type": "string",
          "description": "Description of the trending event."
        },
        "occurredAt": {
          "type": "string",
          "description": "Date and time the trending event occurred.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "topic",
        "description",
        "occurredAt"
      ]
    },
    "Subscription": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Subscription",
      "type": "object",
      "description": "Represents a user's subscription to CreatorX SEO.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the subscription."
        },
        "planType": {
          "type": "string",
          "description": "Type of subscription plan (e.g., Free, Premium Monthly, Premium Annual)."
        },
        "startDate": {
          "type": "string",
          "description": "Date the subscription started.",
          "format": "date-time"
        },
        "endDate": {
          "type": "string",
          "description": "Date the subscription ends.",
          "format": "date-time"
        },
        "paymentMethod": {
          "type": "string",
          "description": "Payment method used for the subscription."
        }
      },
      "required": [
        "id",
        "planType",
        "startDate",
        "endDate",
        "paymentMethod"
      ]
    },
    "WhatsAppSession": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WhatsAppSession",
      "type": "object",
      "description": "Represents a WhatsApp session for personalized guidance (Premium).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the WhatsApp session."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N WhatsAppSession)"
        },
        "sessionId": {
          "type": "string",
          "description": "The session ID for the Whatapp interaction"
        },
        "startTime": {
          "type": "string",
          "description": "Date and time the WhatsApp session started.",
          "format": "date-time"
        },
        "endTime": {
          "type": "string",
          "description": "Date and time the WhatsApp session ended.",
          "format": "date-time"
        },
        "messages": {
          "type": "array",
          "description": "A log of messages for the session",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "userId",
        "startTime",
        "endTime"
      ]
    },
    "Category": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Category",
      "type": "object",
      "description": "Represents a category for content ideas.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the category."
        },
        "name": {
          "type": "string",
          "description": "Name of the category (e.g., Tech, Beauty, Finance)."
        },
        "description": {
          "type": "string",
          "description": "Description of the category."
        }
      },
      "required": [
        "id",
        "name",
        "description"
      ]
    }
  },
  "auth": {
    "providers": [
      "google.com",
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Collection of user documents. Each document represents a user of the CreatorX SEO platform.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/channelAccounts/{channelAccountId}",
        "definition": {
          "entityName": "ChannelAccount",
          "schema": {
            "$ref": "#/backend/entities/ChannelAccount"
          },
          "description": "Collection of channel accounts owned by a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "channelAccountId",
              "description": "The unique identifier for the channel account."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/contentIdeas/{contentIdeaId}",
        "definition": {
          "entityName": "ContentIdea",
          "schema": {
            "$ref": "#/backend/entities/ContentIdea"
          },
          "description": "Collection of content ideas owned by a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "contentIdeaId",
              "description": "The unique identifier for the content idea."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/keywords/{keywordId}",
        "definition": {
          "entityName": "Keyword",
          "schema": {
            "$ref": "#/backend/entities/Keyword"
          },
          "description": "Collection of keywords researched by a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "keywordId",
              "description": "The unique identifier for the keyword."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/competitors/{competitorId}",
        "definition": {
          "entityName": "Competitor",
          "schema": {
            "$ref": "#/backend/entities/Competitor"
          },
          "description": "Collection of competitors analyzed by a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "competitorId",
              "description": "The unique identifier for the competitor."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/trendEvents/{trendEventId}",
        "definition": {
          "entityName": "TrendEvent",
          "schema": {
            "$ref": "#/backend/entities/TrendEvent"
          },
          "description": "Collection of trend events relevant to a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "trendEventId",
              "description": "The unique identifier for the trend event."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/whatsAppSessions/{sessionId}",
        "definition": {
          "entityName": "WhatsAppSession",
          "schema": {
            "$ref": "#/backend/entities/WhatsAppSession"
          },
          "description": "Collection of WhatsApp sessions for personalized guidance for a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "sessionId",
              "description": "The unique identifier for the WhatsApp session."
            }
          ]
        }
      },
      {
        "path": "/channelAccounts/{channelAccountId}/videoMetrics/{videoMetricsId}",
        "definition": {
          "entityName": "VideoMetrics",
          "schema": {
            "$ref": "#/backend/entities/VideoMetrics"
          },
          "description": "Collection of video metrics for a specific channel account. This structure is denormalized with userId field from the parent ChannelAccount for authorization independence.",
          "params": [
            {
              "name": "channelAccountId",
              "description": "The unique identifier for the channel account."
            },
            {
              "name": "videoMetricsId",
              "description": "The unique identifier for the video metrics."
            }
          ]
        }
      },
      {
        "path": "/categories/{categoryId}",
        "definition": {
          "entityName": "Category",
          "schema": {
            "$ref": "#/backend/entities/Category"
          },
          "description": "Collection of categories for content ideas.",
          "params": [
            {
              "name": "categoryId",
              "description": "The unique identifier for the category."
            }
          ]
        }
      },
      {
        "path": "/subscriptions/{subscriptionId}",
        "definition": {
          "entityName": "Subscription",
          "schema": {
            "$ref": "#/backend/entities/Subscription"
          },
          "description": "Collection of subscriptions. NOT user-specific, so no /users/{userId} prefix.",
          "params": [
            {
              "name": "subscriptionId",
              "description": "The unique identifier for the subscription."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to ensure Authorization Independence, clarity, and scalability for the CreatorX SEO platform. We leverage path-based ownership for user-specific data and denormalization to avoid `get()` calls in security rules. All documents in a collection share the same security requirements.\n\n*   **Authorization Independence:** User-owned data (ChannelAccounts, ContentIdeas, Keywords, Competitors, TrendEvents, WhatsAppSessions) are stored under `/users/{userId}`. This structure allows direct ownership checks using `request.auth.uid == userId` in security rules without needing to `get()` parent documents. No `get()` calls are necessary, enhancing security and atomicity.\n\n*   **Structural Segregation:** Each top-level collection (e.g., `/users/{userId}/channelAccounts`) contains documents with uniform access control requirements, simplifying security rules.\n\n*   **QAPs:** The structure supports secure `list` operations by ensuring that all documents within a user's path are owned by that user. This enables secure listing based on path-based ownership."
  }
}